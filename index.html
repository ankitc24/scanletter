<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Name Scanner (Ultra Small)</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>

<style>
body { font-family: Arial, sans-serif; padding: 10px; }

#cameraBox {
    max-width: 350px;
    height: 40px;              /* very small height */
    border: 3px solid red;
    margin: auto;
}

video {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

button {
    width: 100%;
    padding: 8px;
    margin-top: 6px;
    font-size: 15px;
}

table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 12px;
}

th, td {
    border: 1px solid black;
    padding: 6px;
    text-align: center;
}

th { background: #f2f2f2; }

.delete-btn {
    background: red;
    color: white;
    border: none;
    padding: 4px 8px;
    cursor: pointer;
}
</style>
</head>

<body>

<h3 align="center">üìè Ultra Small Name Scanner</h3>
<p align="center">Align ONLY the name inside red strip</p>

<div id="cameraBox">
    <video id="video" autoplay playsinline muted></video>
</div>

<button onclick="startCamera()">Start Camera</button>
<button onclick="scan()">Scan Name</button>
<button onclick="exportExcel()">Export to Excel</button>

<table>
<thead>
<tr>
    <th>Sl No</th>
    <th>Name (2 words)</th>
    <th>Action</th>
</tr>
</thead>
<tbody id="tbody"></tbody>
</table>

<canvas id="canvas" style="display:none;"></canvas>

<script>
let sl = 1;
let stream = null;
const video = document.getElementById("video");

async function startCamer
